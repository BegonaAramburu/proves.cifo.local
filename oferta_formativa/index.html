<!doctype html>
<html lang="en">
<head>
	<title>web.cifo.local.centros</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

	<!-- Fonts Awssome -->
 	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
 	
 	<!-- CSS propio -->
	<link rel="stylesheet" href="/css/style.css">
    
    <!-- datatable bootstrap 4 -->
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">
	
	<style>
		#buscar {
			background-color: #01A5D5 !important;	
		}
		#filtrar{
			background-color: #01A5D5 !important;	
		}
		.form-group{
			padding-left:10px !important;
			padding-right:10px !important;
		}
		
	</style>
</head>
<body>
	
	<!--Creación del Navegador ---------------------------------------------------------------------->
	
	<nav class="navbar navbar-expand-md fixed-top p-0 pr-2 navbar-dark bg-info">
		<div >
		    <img src="/img/soc.jpg"  height="55px" alt="Logo SOC">
			<a class="navbar-brand p-0 m-0 d-inline-block text-wrap" style="line-height: 1em; " href="#">Servei d'Ocupació<br> de Catalunya</a>
		</div>
		<button class="navbar-toggler " type="button" data-toggle="collapse"
			data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown"
			aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button> 
		<div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
			<ul class="navbar-nav ">
				<li class="nav-item"><a class="nav-link" href="#">Centros</a></li>
				<li class="nav-item active"><a class="nav-link" href="#">Oferta formativa</a></li>
				<li class="nav-item"><a class="nav-link" href="#">Biblioteca</a></li>
				<li class="nav-item"><a class="nav-link" href="#">Contacto</a></li>
				<li class="nav-item"><a class="nav-link d-block d-md-none d-lg-block" href="/campus/index.html">Campus virtual</a></li>
				<li class="nav-item"><a class="nav-link  d-block d-md-none d-lg-block" href="#">Entrar</a></li>
				<li class="nav-item"><a class="nav-link d-block d-md-none d-lg-block" href="#">Regístrate</a></li>
				<li class="nav-item dropdown d-none d-md-inline d-lg-none">
					<a class="nav-link dropdown-toggle" href="#"
					id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
					aria-haspopup="true" aria-expanded="false"> eCampus </a>
					<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
						<a class="dropdown-item" href="/campus/index.html">Campus Virtual</a> 
						<a class="dropdown-item" href="#">Entrar</a>
						<a class="dropdown-item" href="#">Regístrate</a>
					</div>
				</li>
			</ul>
		</div>
	</nav>
	
	<!-- Creación del breadcrumb y redes sociales---------------------------------------------------------------------->
	
	<div class="row mx-2 border-bottom border-secondary" style="margin-top:55px">
		<div class="col p-0 ">
	 		<nav aria-label="breadcrumb"> 
	 			<ol class="breadcrumb m-0 mt-3 bg-transparent p-0">
	 		 		<li><i class="fa fa-home text-info"></i></li>
	 		 		<li class="breadcrumb-item text-info pl-2"><a href="/index.html">Inicio</a></li>
	    			<li class="breadcrumb-item active " aria-current="page">Oferta formativa</li>
	  		 	</ol>
			</nav>
		</div>
		<div class="col d-flex py-2 justify-content-end align-items-center">
	    	<a class="mr-1 p-1 py-1 d-inline-block rounded-circle text-white" style="background-color:#1B1FBA" href="#"><i class="fa fa-facebook fa-fw "></i></a>
	      	<a class="mr-1 p-1 py-1 d-inline-block rounded-circle text-white" style="background-color:#00acee" href="#"><i class="fa fa-twitter fa-fw"></i></a>
	      	<a class="mr-1 p-1 py-1 d-inline-block rounded-circle text-white" style="background-color:#CC4115" href="#"><i class="fa fa-google-plus fa-fw"></i></a>
	      	<a class="mr-1 p-1 py-1 d-inline-block rounded-circle bg-dark text-white" href="#"><i class="fa fa-instagram fa-fw"></i></a>
	      	<a class="mr-1 p-1 py-1 d-inline-block rounded-circle bg-danger text-white" href="#"><i class="fa fa-pinterest fa-fw"></i></a>
		</div>
	</div>
 
 <!-- Creación del contenido ---------------------------------------------------------------------->
 			<!-- ---------------creación flitros y selecciones----------------------------------- -->
 	<div class="row">
 		<div class="col-12 col-lg-4 px-0 ">
 			<h4 class="ml-4 mt-3"> Oferta formativa</h4>
 			<div class="mx-lg-4">
	 			<div id="buscar" class="col bg-info d-flex p-3   border border-light rounded">
	 				<a class="text-white" style="line-height: 1em; " href="#"><i class=" fa fa-search mx-2"></i>Buscar</a>
	 			</div>
	 			<div class="border border-light rounded pb-3 mb-3 mt-4">
		 			<div id="filtrar" class="col-12 bg-info d-flex p-3 border-light rounded-top">
		 			<a class="text-white" style="line-height: 1em; " href="#"><i class="fa fa-filter mx-2"></i>Filtrar</a>
		 			</div>
	 				<div class="pb-3 px-3" >
	 					<form>
					  		<div class="form-group mt-4">
					    		<label for="exampleFormControlSelect1">Familia Profesional</label>
					   			<select class="form-control" id="familiaProfesional">
					     			<option value="">--Elija una opción--</option>
					    		</select>
					   			<small class="form-text text-muted"><em>Lista de famílias profesionales</em></small>
					  		</div>
					   		<div class="form-group">
					    		<label for="exampleFormControlSelect1">Cursos</label>
					   			<select class="form-control" id="cursos">
					     			<option value="">--Elija una opción--</option>
					    		</select>
					    		<small class="form-text text-muted"><em>Lista de cursos</em></small>
					  		</div>
							<div class="form-group">
								<label for="exampleFormControlSelect1">Centros de formación</label>
							    <select class="form-control" id="centrosFormacion">
							    	<option value="">--Elija una opción--</option>
							    </select>
							    <small class="form-text text-muted"><em>Lista de centros de formación</em></small>
							</div>
						</form>
						<div class="d-flex justify-content-center mt-5">
							<button type="button" id="btnBorrar" class="btn btn-danger mr-1">Borrar</button>
							<button type="button" id="btnFiltrar" class="btn btn-info ml-1">Filtrar</button>
						</div>
	 				</div>
	 			</div>
 			</div>
 		</div>
 		<div class="col-lg-8 offset-lg-4 ml-0 style="margin-top:55px"">
 		
 		 			<!-- ---------------creación datatable----------------------------------- -->
 		 			
			<div class="card-body">
				<div class="table-responsive">
					<table id="tablaOfertas" class="table table-striped table-bordered" >
			
			    <thead>
			        <tr>
			            <th>Código</th>
			            <th>Curso</th>
			            <th>Area</th>
			            <th>Centro</th>
			            <th>Inicio</th>
			            <th>Fin</th>
			        </tr>
			    </thead>
			    <tbody></tbody>
			</table>
 		</div>
 		</div>
 		</div>
 	</div>	

 
 
 
 
 
 
 
 <!-- Creación del footer ---------------------------------------------------------------------->	
			<!-- ---------------redes sociales----------------------------------- -->
	<footer id="footer" class="container-fluid text-light">
		<div class="row d-flex justify-content-center align-items-center">
	      <a class="mr-1 p-1 py-2 d-inline-block  bg-transparent text-light" href="#"><i class="fa fa-twitter fa-2x fa-fw "></i></a>
	      <a class="mr-1 p-1 py-2 d-inline-block bg-transparent text-light" href="#"><i class="fa fa-facebook fa-2x fa-fw"></i></a>
	      <a class="mr-1 p-1 py-2 d-inline-block bg-transparent text-light" href="#"><i class="fa fa-google-plus fa-2x fa-fw"></i></a>
	      <a class="mr-1 p-1 py-2 d-inline-block bg-transparent text-light" href="#"><i class="fa fa-instagram fa-2x fa-fw"></i></a>
	      <a class="mr-1 p-1 py-2 d-inline-block bg-transparent text-light" href="#"><i class="fa fa-pinterest fa-2x fa-fw"></i></a>
		</div>
		   <!-- ---------------directo a----------------------------------- -->
		<div class="row mt-4">
			<div class="col-12 col-md-3 d-flex justify-content-center text-center">
				<ul type="none" class="p-0 mb-5 mb-md-2">
					<li class="text-white"><h6>DIRECTO A</h6></li>
					<li><a class="text-light" href="/centros/index.html">Centros</a></li>
					<li><a class="text-light" href="#">Oferta formativa</a></li>
					<li><a class="text-light" href="#">Biblioteca</a></li>
					<li><a class="text-light" href="#">Contacto</a></li>
					<li><a class="text-light" href="/campus/index.html">Campus virtual</a></li>
					<li><a class="text-light" href="#">Entrar</a></li>
					<li><a class="text-light" href="#">Registrarse</a></li>
				</ul>
			</div>
			 <!-- ---------------ayuda----------------------------------- -->
			<div class="col-12 col-md-3 d-flex justify-content-center text-center">
				<ul type="none" class="p-0 mb-5 mb-md-2">
					<li class="text-white"><h6>AYUDA</h6></li>
					<li><a class="text-light" href="#">Sobre gencat</a></li>
					<li><a class="text-light" href="#">Accessibilitat</a></li>
					<li><a class="text-light" href="#">Mapa web</a></li>
					<li><a class="text-light" href="#legal">Aviso Legal</a></li>
				</ul>
			</div>
			 <!-- ---------------aviso legal--------------------------------- -->
			<div class="col-12 col-md-6">
				<div class="text-center d-flex justify-content-center">
					<h6 class="text-white" id="legal">SERVEI D'OCUPACIÓ DE CATALUNYA</h6>
				</div>
				<p class="col-12 d-flex justify-content-center class text-center mb-5 mb-md-2">
				 Aviso legal : De acuerdo con el artículo 17.1 de la Ley 19/2014, la © Generalidad de Cataluña permite la reutilización de los contenidos y de los datos siempre que
	se cite la fuente y la fecha de actualización y que no se desnaturalice la información (artículo 8 de la Ley 37/2007) y también que no se contradiga con una licencia específica.
				</p>
				
				<div class="row">
					<div class="col-6">
						<img src="/img/sepelogotip.jpg" title="logotipo sepe" alt="logotipo sepe" class="img-fluid">
					</div>
					<div class="col-6">
						<img src="/img/logotip_Iniciativaocupaciojuvenil_bn.jpg" title="logotipo sepe" alt="logotipo sepe" class="img-fluid">
					</div>
				</div>
			</div>
		</div>
		<div class="d-flex justify-content-center class text-center py-3 ">Copyright © Cifo 2018 </div>
     </footer>

	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<!-- datatable JS -->
	<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>

	<script>
	
	//----------------crear variable tipo XMLHttpRequest para todo tipo de navegadores------------------
	
	var xhr;
	if(window.XMLHttpRequest) {
		xhr = new XMLHttpRequest();
		}else if(window.ActiveXObject) {
		peticion_http = new ActiveXObject("Microsoft.XMLHTTP");
		}
	
	//-----------------------Llamada AJAX para rellenar la Família Profesional--------------------------
	
	xhr.onreadystatechange = function(){
 		if(xhr.readyState==4 && xhr.status==200){
 			var objAreas = JSON.parse(xhr.responseText);
			//console.log(objAreas);
			var arrAreas = objAreas.records;
			//console.log(arrAreas);
			for(var i=0; i<arrAreas.length; i++){
				var cadena = '<option value="' + arrAreas[i].id + '">' + arrAreas[i].nombre + '</option>';
				document.getElementById("familiaProfesional").innerHTML+=cadena;
			}
 		}
 	}	
	xhr.open('GET','http://app.cifo.local/api/public/formacion/areas/', true);
 	xhr.send();		
	
 	//-------------Llamada AJAX para rellenar los cursos según el id dela Família Profesional--------------
 	
	document.getElementById("familiaProfesional").onchange = function(){
		document.getElementById("cursos").innerHTML = '<option value="">--Elija una opción--</option>';
		xhr.onreadystatechange = function(){
	 		if(xhr.readyState==4 && xhr.status==200){
	 			var objCursos = JSON.parse(xhr.responseText);	
				//console.log(objCursos);
				var arrCursos = objCursos.records;
				//console.log(arrCursos);
				for(var i=0; i<arrCursos.length; i++){
					var cadena = '<option value="' + arrCursos[i].id + '">' + arrCursos[i].nombre + '</option>';
					document.getElementById("cursos").innerHTML+=cadena;
					
				}
	 		}
	 	}	

		xhr.open('GET','http://app.cifo.local/api/public/formacion/cursos/area/' + this.value +'/', true);
	 	xhr.send();		
	}
	
	//---------------Llamada AJAX para rellenar los centros--------------------------
	
	var xhr1;
	if(window.XMLHttpRequest) {
		xhr1 = new XMLHttpRequest();
		}else if(window.ActiveXObject) {
		peticion_http = new ActiveXObject("Microsoft.XMLHTTP");
		}
	
	xhr1.onreadystatechange = function(){
 		if(xhr1.readyState==4 && xhr1.status==200){
 			var objCentros = JSON.parse(xhr1.responseText);
			//console.log(objCentros);
			var arrCentros = objCentros.records;
			//console.log(arrCentros);
			for(var i=0; i<arrCentros.length; i++){
				var cadena = '<option value="' + arrCentros[i].id + '">' + arrCentros[i].nombre + '</option>';
				document.getElementById("centrosFormacion").innerHTML+=cadena;
			}
 		}
	}	
	xhr1.open('GET','http://app.cifo.local/api/public/formacion/centros/', true);
 	xhr1.send();		
	
 	//------------------------------------------Datatable --------------------------------------
	
 	var tabla;
 	tabla=$('#tablaOfertas').DataTable({
 		language:{
 			url: "spanishdatatable.json"
 		},
 		"columnDefs":[
 			{"data": "codigoferta", "targets": 0 },
 			{"data": "curso", "targets": 1 },
 			{"data": "area", "targets": 2 },
 			{"data": "centro", "targets": 3 },
 			{"data": "datainicio", "targets": 4 },
 			{"data": "datafin", "targets": 5 },
 			
 		]
 	});
 	//---------------Llamada AJAX para rellenar datatable de ofertas--------------------------
 	var xhr2;
	if(window.XMLHttpRequest) {
		xhr2 = new XMLHttpRequest();
		}else if(window.ActiveXObject) {
		peticion_http = new ActiveXObject("Microsoft.XMLHTTP");
		}

	xhr2.onreadystatechange = function(){
 		if(xhr2.readyState==4 && xhr2.status==200){
 			var objOfertas = JSON.parse(xhr2.responseText);
			//console.log(objOfertas);
			var arrOfertas = objOfertas.records;
			//console.log(arrOfertas);
			for(var i=0; i<arrOfertas.length; i++){
				tabla.row.add({
					"codigoferta":'<a href="javascript:void(0)" onclick="editOferta()">'+arrOfertas[i].codigoferta+'</a>',
					"curso": arrOfertas[i].curso,
					"area": arrOfertas[i].area,
					"centro": arrOfertas[i].centro,
					"datainicio": arrOfertas[i].datainicio,
					"datafin": arrOfertas[i].datafin
				})
				
			}
			tabla.draw();
 		}
	}
	xhr2.open('GET','http://app.cifo.local/api/public/formacion/ofertas/', true);
 	xhr2.send();		
 	
 	
 	document.getElementById("btnFiltrar").onclick = function(){
 		tabla.clear().draw();
 		var areaId = document.getElementById("familiaProfesional").value;
 		var cursoId = document.getElementById("cursos").value;
 		
 		xhr.onreadystatechange = function(){
	 		if(xhr.readyState==4 && xhr.status==200){
	 		/*	var objCursos = JSON.parse(xhr.responseText);	
				//console.log(objCursos);
				var arrCursos = objCursos.records;
				//console.log(arrCursos);
				for(var i=0; i<arrCursos.length; i++){
					var cadena = '<option value="' + arrCursos[i].id + '">' + arrCursos[i].nombre + '</option>';
					document.getElementById("cursos").innerHTML+=cadena;
					
				}
	 		}
	 	}	*/
	
 		
 		
 		
 		
 	}
 	
	</script>
	
</body>
</html>
 	
 	
 	
 	
 	
 	
 	
 	
 	
 	
 	
 	